<!DOCTYPE html>
<html>
    <head>
        <title>Page title</title>
    </head>
    <body>
        <h2>Login Form</h2>
        <form id="loginForm">
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" required><br>

            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required><br>

            <!-- Error message display -->
            <p id="errorMessage" style="color: red; display: block;"></p>

            <button id="btn" type="button">Login</button>
        </form>
        <script>
            document.getElementById('btn').addEventListener('click', function (event) {

                const formData = {
                    username: document.getElementById('username').value,
                    password: document.getElementById('password').value
                };

                // Send JSON data using Fetch API
                fetch('http://localhost:3000/account', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                })
                .then(response => {
                    if (response.ok) {
                        // Get the HTML content from the response
                        return response.text();
                    } else {
                        // Parse the response JSON to extract the error message
                        return response.json()
                            .then(data => Promise.reject(data.error));
                    }
                })
                .then(htmlContent => {
                    // Replace the current page's content with the received HTML content
                    document.documentElement.innerHTML = htmlContent;
                    /* history.pushState({}, '', '/account'); */

                })
                .catch(error => {
                    // Handle login failure
                    document.getElementById('errorMessage').innerText = error;
                    document.getElementById('username').style.border = '1px solid red';
                    document.getElementById('password').style.border = '1px solid red';
                });
            });
        </script>
        
    </body>
</html>
